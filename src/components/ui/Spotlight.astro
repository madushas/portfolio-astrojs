---
interface Props {
	translateY?: number;
	width?: number;
	smallWidth?: number;
	xOffset?: number;
	duration?: number;
}

const {
	translateY = -400,
	width = 560,
	smallWidth = 240,
	xOffset = 120,
	duration = 7,
} = Astro.props;
---

<div class="spotlight-container pointer-events-none absolute inset-0 z-0 h-full w-full overflow-hidden opacity-0">
  <!-- Left gradients -->
  <div class="pointer-events-none absolute inset-0 z-30">
    <div class="pointer-events-none absolute inset-0 bg-noise opacity-5" />
  </div>

  <div class="absolute top-0 left-0 h-screen w-screen animate-sway-left will-change-transform">
    <div
      class="absolute top-0 left-0 rounded-full will-change-transform"
      style={`
        transform: translateY(${translateY}px) rotate(-45deg);
        width: ${width}px;
        height: 1380px;
      `}
    >
      <div class="w-full h-full bg-gradient-primary-soft"></div>
    </div>
    <div
      class="absolute top-0 left-0 rounded-full will-change-transform"
      style={`
        transform: rotate(-45deg) translate(5%, -50%);
        width: ${smallWidth}px;
        height: 1380px;
      `}
    >
      <div class="w-full h-full bg-gradient-accent-soft"></div>
    </div>
  </div>

  <!-- Right gradients -->
  <div class="absolute top-0 right-0 h-screen w-screen animate-sway-right will-change-transform">
    <div
      class="absolute top-0 right-0 rounded-full will-change-transform"
      style={`
        transform: translateY(${translateY}px) rotate(45deg);
        width: ${width}px;
        height: 1380px;
      `}
    >
      <div class="w-full h-full bg-gradient-primary-soft"></div>
    </div>
    <div
      class="absolute top-0 right-0 rounded-full will-change-transform"
      style={`
        transform: rotate(45deg) translate(-5%, -50%);
        width: ${smallWidth}px;
        height: 1380px;
      `}
    >
      <div class="w-full h-full bg-gradient-accent-soft"></div>
    </div>
  </div>
</div>

<script>
  // Only animate when in viewport
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate-fade-in');
        }
      });
    },
    { threshold: 0.1 }
  );

  document.querySelectorAll('.spotlight-container').forEach((el) => {
    observer.observe(el);
  });
</script>

<style define:vars={{ xOffset: `${xOffset}px`, duration: `${duration}s` }}>
  .animate-fade-in {
    animation: fadeIn 1.5s ease-out forwards;
  }

  @media (prefers-reduced-motion: no-preference) {
    .animate-sway-left {
      animation: swayLeft var(--duration) ease-in-out infinite alternate;
    }

    .animate-sway-right {
      animation: swayRight var(--duration) ease-in-out infinite alternate;
    }
  }

  @keyframes swayLeft {
    0% { transform: translateX(0); }
    100% { transform: translateX(var(--xOffset)); }
  }

  @keyframes swayRight {
    0% { transform: translateX(0); }
    100% { transform: translateX(calc(var(--xOffset) * -1)); }
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
</style>
