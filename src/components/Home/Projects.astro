---
import { localProjects } from "../../data/localProjects";
import SectionContainer from "../shared/SectionContainer.astro";
import ProjectCard from "./ProjectCard.astro";

// Using local data to reflect new AI Researcher/Founding Engineer persona immediately
// Sanity integration can be restored later if needed
const projects = localProjects;
const error = null;
---

<SectionContainer id="projects" title="Selected Work" subtitle="Selected projects and experiments.">
  {error ? (
    <div class="flex flex-col items-center justify-center py-16 gap-4">
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-destructive"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
      <span class="text-destructive font-bold uppercase tracking-wider">Failed to load projects.</span>
    </div>
  ) : projects.length === 0 ? (
    <div class="container-custom grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5 md:gap-6">
      {[1, 2, 3, 4, 5, 6].map(() => (
        <div class="flex h-full flex-col border-2 border-border bg-card">
          <!-- Skeleton Image -->
          <div class="w-full aspect-video border-b-2 border-border skeleton"></div>

          <!-- Skeleton Body -->
          <div class="flex flex-1 flex-col p-5 md:p-6 lg:p-7 xl:p-8 space-y-4">
            <div class="flex items-start justify-between gap-3">
              <div class="h-6 w-2/3 skeleton rounded"></div>
              <div class="h-5 w-12 skeleton rounded"></div>
            </div>

            <div class="flex gap-2">
              <div class="h-6 w-16 skeleton rounded"></div>
              <div class="h-6 w-20 skeleton rounded"></div>
            </div>

            <div class="space-y-2 flex-1">
              <div class="h-4 w-full skeleton rounded"></div>
              <div class="h-4 w-full skeleton rounded"></div>
              <div class="h-4 w-3/4 skeleton rounded"></div>
            </div>

            <div class="pt-5 border-t-2 border-border flex items-center justify-between">
              <div class="h-4 w-32 skeleton rounded"></div>
              <div class="flex gap-2">
                <div class="h-8 w-8 skeleton rounded"></div>
                <div class="h-8 w-8 skeleton rounded"></div>
              </div>
            </div>
          </div>
        </div>
      ))}
    </div>
  ) : (
    <div class="container-custom grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5 md:gap-6">
      {projects.map((project: any, index: number) => (
        <div class="animate-fade-in" style={`animation-delay: ${index * 0.1}s`}>
          <ProjectCard {...project} index={index} />
        </div>
      ))}
    </div>
  )}
</SectionContainer>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fadeIn 0.6s ease-out forwards;
    opacity: 0;
  }
</style>
